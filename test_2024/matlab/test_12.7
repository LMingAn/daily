% P1、P2、P3、P4、P5。每个项目需要初始投资 100,000 美元
% Expansion(扩张) Slowdown(减速) Recovery(复苏) Recession(衰退) -- (单位：千美元)
% P1 150            105             95              70
% P2 115            101             100             80
% P3 150            120             98              50
% P4 130            115             90              85
% P5 123            113             93              73
% 经济周期的四个阶段(扩张、减速、复苏、衰退)通过 GDP 年同比增长率 X(w)定义如下:
% 如果x > 10%，则为扩张;
% 如果 0% < x < 10%，则为减速;
% 如果 -10% < x ≤ 0%，则为复苏;
% 如果 x < -10%，则为衰退。
% 在未来一年内处于减速的概率与处于复苏的概率相同，估计为 35%。
% 风险管理团队估计，观察到衰退的概率是观察到扩张概率的一半。
% 在未来一年内发生重大损失的概率为 10%（即损失超过最初分配资金的 50%）
% 每个项目将持续 4 年，且发生重大损失的 10% 概率在整个项目期间保持不变
% (a)指定样本空间、感兴趣的随机变量和相关的概率。
% (b)计算每个项目的预期回报。
% (c)计算每个项目回报的标准差。
% 公司有 1,000,000 美元，计算组合项目的预期回报和标准差
% (d)如果公司决定在每个项目中平均投资相同金额。
% (e)如果公司按以下公式在项目i中投资可用现金的比例
% (f)求在未来 4 年内没有重大损失的概率。
% (g)求在未来 4 年内发生一次重大损失的概率。
% (h)求在未来 4 年内发生两次重大损失的概率。
% (i)求在未来 4 年内发生三次或更多重大损失的概率。
% 作为最终任务，你被要求近似每个项目的回报分布为正态分布，使用 (b) 和 (c) 中获得的均值和标准差。
% (j)CFO 选择的项目组合的分布是什么？
% 考虑到为项目选择的分配：
% (k)求在未来一年内回报率大于 2% 的概率。
% (l)求在未来一年内回报率小于 2% 的概率。
% (m)求在未来一年内正回报的概率。
% (n)求所选择项目组合的回报分布的十分位数。

%(a):扩张：20% 减速：35% 复苏：35% 衰退：10%
%(b):期望回报：P1:107.00 P2:101.35 P3:111.30 P4:106.25 P5:104.00
%(c):标准差：P1:23.63 P2:9.14 P3:27.64 P4:16.65 P5:15.46
%(d):间：平均分配方案 (d)：组合期望回报：105.98 组合标准差：8.77
%(e):基于风险的分配方案 (e)：组合期望回报：104.76 组合标准差：7.15
% 我会建议像(e)那样分配资源，因为这样更符合CFO的预期
%(f)
p = 0.1;%重大损失概率 
n = 4;
p_0 = (1 - p) ^ n;
disp(['未来 4 年内没有重大损失的概率为：', num2str(p_0)]);
%(g)
p_1 = (1 - p) ^ (n - 1) * n * p;
disp(['未来 4 年内发生一次重大损失的概率为：', num2str(p_1)]);
%(h)
p_2 = (1 - p) ^ (n - 2) * nchoosek(n, 2) * p ^ 2;
disp(['未来 4 年内发生两次重大损失的概率为：', num2str(p_2)]);
%(i)
p_3 = (1 - p) ^ (n - 3) * nchoosek(n, 3) * p ^ 3;
p_4 = (1 - p) ^ (n - 4) * nchoosek(n, 4) * p ^ 4;
p_more = p_3 + p_4;
disp(['未来 4 年内发生三次或更多重大损失的概率为：', num2str(p_more)]);
%(j):CFO选择的项目组合分布为基于风险的分配(e)
%(k)
mu = 104.76;%期望回报均值
sigma = 7.15;%标准差
p_more2 = 1 - normcdf((102 - mu) / sigma);
%(l)
p_less2 = normcdf((102 - mu) / sigma);
%(m)
p_positive = 1 - normcdf((100 - mu) / sigma);
%(n)
q_10 = mu + sigma * norminv(0.1);
disp(['未来一年内回报率大于 2% 的概率为：', num2str(p_more2)]);
disp(['未来一年内回报率小于 2% 的概率为：', num2str(p_less2)]);
disp(['未来一年内正回报的概率为：', num2str(p_positive)]);
disp(['所选择项目组合的回报分布的十分位数为：', num2str(q_10)]);